# Лабораторная работа №5  
## Динамический анализ уязвимостей веб-приложения с использованием OWASP ZAP

### Выполнил: Погосян Николай
---

## Цель работы

Освоить практические навыки динамического анализа безопасности веб-приложений с применением инструмента OWASP ZAP, а также выявить и проанализировать уязвимости в уязвимом Flask-приложении.

---

## Используемое программное обеспечение

- Операционная система: Ubuntu Linux  
- Язык программирования: Python 3  
- Веб-фреймворк: Flask  
- Инструмент анализа безопасности: OWASP ZAP 2.16.1  

---

## Описание тестируемого приложения

В рамках лабораторной работы используется уязвимое веб-приложение на базе Flask, доступное по адресу:

http://localhost:5000

---


Приложение реализует следующие маршруты:

- `/` — главная страница приложения  
- `/ping?host=8.8.8.8` — выполнение системной команды ping на основе пользовательского ввода  
- `/search?q=test` — поиск по пользовательскому параметру  

Приложение намеренно содержит небезопасные механизмы обработки пользовательского ввода и конфигурационные недостатки.

---

## Запуск уязвимого приложения

Приложение запускается следующей командой:

```bash
python vulnerable_app.py
```

После запуска сервер доступен по адресам:

```bash
http://127.0.0.1:5000
http://localhost:5000
```

<img width="1257" height="782" alt="image" src="https://github.com/user-attachments/assets/465942b5-b93f-441a-b6cb-0c0f1aa6b4d4" />

---

## Проверка доступности маршрутов

В браузере выполнена проверка следующих URL:

```bash
http://localhost:5000/ping?host=8.8.8.8
http://localhost:5000/search?q=test
```

Оба маршрута корректно обрабатываются сервером.

<img width="1267" height="776" alt="image" src="https://github.com/user-attachments/assets/4024e646-9b1b-4401-a624-b2cad0a69cde" />
<img width="1269" height="775" alt="image" src="https://github.com/user-attachments/assets/da3335a9-4341-465b-97c7-87106823163d" />


---

## Запуск OWASP ZAP

Инструмент OWASP ZAP был запущен в стандартном режиме (Standard Mode).

<img width="1277" height="799" alt="image" src="https://github.com/user-attachments/assets/abb08700-0b1e-4512-891d-8fed8d23fd9b" />

---

## Автоматическое сканирование приложения

В OWASP ZAP выполнены следующие действия:

 1. Открыт раздел «Быстрый старт».

 2. Выбран пункт «Автоматическое сканирование».

 3. В поле URL для атаки указан адрес:

```bash
http://localhost:5000
```

 4. Включено использование традиционного паука и AJAX Spider.

 5. Запущена атака нажатием кнопки «Атака».

 6. По завершении сканирования проанализированы результаты во вкладке «Оповещения».

<img width="1279" height="805" alt="image" src="https://github.com/user-attachments/assets/e4c26f0a-477d-4b70-b9a9-27724a4aaedd" />
<img width="1282" height="805" alt="image" src="https://github.com/user-attachments/assets/ef10aa79-c71c-4791-b170-9c91e363d442" />
<img width="1204" height="756" alt="image" src="https://github.com/user-attachments/assets/5f46ad7c-af5f-4bb1-9891-a807b7397778" />

---

## Результаты сканирования OWASP ZAP

В ходе анализа были выявлены следующие уязвимости.

---
### 1. Отсутствует заголовок Content Security Policy (CSP)

* URL: http://localhost:5000

* Уровень риска: Средний

* Достоверность: Высокая

* CWE ID: 693

* WASC ID: 15

### Описание:

Content Security Policy (CSP) — это механизм защиты, позволяющий ограничить источники загружаемого контента (скрипты, стили, изображения). Отсутствие CSP увеличивает риск атак межсайтового скриптинга (XSS) и внедрения вредоносного кода.

### Последствия:

Злоумышленник может внедрить и выполнить вредоносный JavaScript-код в браузере пользователя.

### Рекомендация:

Настроить заголовок Content-Security-Policy на стороне веб-сервера или приложения.

<img width="1274" height="795" alt="image" src="https://github.com/user-attachments/assets/e27966ec-ae8a-4dfb-a3e2-34d8483e1094" />

---

### 2. Отсутствует защита от Clickjacking (X-Frame-Options)

* URL: http://localhost:5000

* Уровень риска: Средний

* Достоверность: Средняя

* Параметр: x-frame-options

* CWE ID: 1021

* WASC ID: 15

### Описание:
Отсутствие заголовка X-Frame-Options позволяет встраивать страницу в iframe на стороннем сайте.

### Последствия:
Возможны атаки Clickjacking, при которых пользователь неосознанно выполняет действия на целевом сайте.

### Рекомендация:
Добавить заголовок X-Frame-Options: DENY или SAMEORIGIN.

<img width="1202" height="757" alt="image" src="https://github.com/user-attachments/assets/b8801e35-9ef4-4f11-9186-51cabacddb10" />

---

### 3. Отсутствует заголовок X-Content-Type-Options

* URL: http://localhost:5000

* Уровень риска: Низкий

* Достоверность: Средняя

### Описание:
Отсутствие заголовка X-Content-Type-Options позволяет браузеру самостоятельно определять MIME-тип контента.

### Последствия:
Может привести к выполнению вредоносного содержимого при некорректной обработке типов данных.

### Рекомендация:
Добавить заголовок X-Content-Type-Options: nosniff.

<img width="1192" height="740" alt="image" src="https://github.com/user-attachments/assets/410bdd78-41fc-419a-a04f-61ba0538cb46" />

---

### 4. Утечка информации о версии сервера

* URL: http://localhost:5000

* Уровень риска: Низкий

### Описание:
HTTP-ответы содержат информацию о версии сервера или используемого ПО.

### Последствия:
Злоумышленник может использовать данную информацию для подбора известных уязвимостей.

### Рекомендация:
Ограничить или скрыть информацию о сервере в HTTP-заголовках.

<img width="1209" height="765" alt="image" src="https://github.com/user-attachments/assets/7fd0f8d0-4324-41f8-9623-a4d45089480f" />

---

### Генерация отчёта OWASP ZAP

По результатам сканирования был сформирован HTML-отчёт со следующими параметрами:

* Шаблон: Traditional HTML Report

* Включены все уровни риска

* Включены подтверждённые уязвимости

* Файл отчёта: lr5_zap_report.html

<img width="601" height="540" alt="image" src="https://github.com/user-attachments/assets/041da8cc-7955-4d23-b397-62ea1d0ca09c" />

<img width="1276" height="803" alt="image" src="https://github.com/user-attachments/assets/817a7865-8362-4b2b-9ddc-bd44cfd8b11f" />

---

### Вывод

В ходе лабораторной работы №5 было выполнено динамическое тестирование безопасности веб-приложения с использованием OWASP ZAP. В результате сканирования были выявлены конфигурационные уязвимости, связанные с отсутствием защитных HTTP-заголовков, а также потенциальные риски, связанные с архитектурой приложения. Полученные результаты подтверждают необходимость применения инструментов динамического анализа безопасности при разработке и тестировании веб-приложений.

---

Приложения

* vulnerable_app.py — уязвимое Flask-приложение

* lr5_zap_report.html — HTML-отчёт OWASP ZAP
